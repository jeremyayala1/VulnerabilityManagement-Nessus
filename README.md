<h1>Vulnerability Management - Tenable Nessus Vulnerability Scanner Lab</h1>

<!--
 ### [YouTube Demonstration](https://youtu.be/7eJexJVCqJo)
-->

<h2>Description</h2>
In this project, I set up a Windows 10 environment on a VMware Workstation Virtual Machine. I install some deprecated software on the VM to get some feedback. Then, I use Tenable Nessus Vulnerability Scanner to run a vulnverability scan against the virtual machine to discover any vulnerabilities. Once vulnerabilities are discovered, I will work towards remediating the vulnerabilities to reduce exposure to the workstation.
<br />


<h2>Languages and Utilities Used</h2>

- <b>Tenable Nessus Essentials</b> 
- <b>VMware Workstation Player</b>
- <b>Windows 10 ISO</b>

<h2>Environments Used </h2>

- <b>Windows 10 2022 | Version 22H2 </b> 

<h2>Program walk-through:</h2>

<p align="center">
Download VMware Workstation Player: <br/>
 https://www.vmware.com/products/workstation-player.html <br/>
<img src="https://i.imgur.com/2zEmQHr.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Download the Windows 10 ISO: <br/>
 https://www.microsoft.com/en-us/software-download/windows10 <br/>
 When installing, be sure to select "Create installation media for another PC" and "ISO file" for media to use <br/>
 Create a folder and save that ISO within that folder for future reference <br/>
<img src="https://i.imgur.com/VUfTVG2.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Download Tenable Nessus Essentials: <br/>
https://www.tenable.com/products/nessus/nessus-essentials <br/>
Register for the Activation Code and reference your email <br/>
 In email, click "Download Nessus" -> Tenable Nessus -> View Downloads<br/>
<img src="https://i.imgur.com/eM5nFWL.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Ensure that the platform you're selecting supports Windows 10 (as highlighted in screenshot below) <br/>
 *** It's also a good idea to practice Integrity from the CIA triad by running an MD5 or SHA256 checksum and comparing it to the checksum pictured below *** <br/>
<img src="https://i.imgur.com/lrvkndE.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Once Nessus has been downloaded and installed, it will open a browser tab <br/>
 Select Nessus Essentials -> Hit Skip (on sign-up) -> Enter Activation Code from your email <br/>
 Allow Nessus to complete intial setup <br/>
<img src="https://i.imgur.com/ibBRTxx.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Open VMware Workstation Player <br/>
 Select Player -> File -> New Virtual Machine
<img src="https://i.imgur.com/pq8j3Pm.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
On this page, select the folder and file where you saved the Windows 10 ISO <br/>
 Name it appropriately, set max disk size, and select "Customize Hardware" <br/>
<img src="https://i.imgur.com/0EMHlGO.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
After selecting "Customize Hardware", you can change resources around if you're familiar with your computer; otherwise, leave these alone.<br/>
 *** Most importantly: Select "Network Adapter" -> and under "Network connection" select "Bridged" <br/>
 This allows your PC running Nessus to be able to communicate with your VM easier <br/>
 Close, ensure that "Power on this virtual machine after creation" is checked, and hit Finish <br/>
<img src="https://i.imgur.com/BPROFya.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
At this point, we'll be setting up Windows 10 on our VM. <br/>
 Click through the prompts, and select "I don't have a product key" <br/>
 You can choose any of the Operating Systems; however, I opted in for "Windows 10 Pro" <br/>
 Accept the license terms, and hit Next <br/>
<img src="https://i.imgur.com/vc7vMZq.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Select "Custom: Install Windows only" <br/>
 Select the only drive available and hit Next <br/>
<img src="https://i.imgur.com/fjSFR2W.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
Continue setting up your Windows 10 VM environment <br/>
 Select "Set up for personal use" <br/>
 Select "Offline  Account" <br/>
 Seclet "Limited Experience" <br/>
 Create a username and password for your VM <br/>
 Click through and allow your VM desktop to load <br/>
<img src="https://i.imgur.com/RPBW11J.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
 Open Command Prompt by typing "cmd" in the bottom search bar <br/>
 Type "ipconfig" and hit enter to get the ipaddress of the virtual machine <br/>
 Retrive your internal ip address from the line that says "IPv4 Address" <br/>
<img src="https://i.imgur.com/h3KGgAX.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
We are going to test connectivity to our virtual machine by pinging it from our host machine <br/>
 Open cmd on your host computer, type "ping (the IPv4 of your VM) -t" <br/>
 Initially, you'll notice that the requests time out (VM can't be pinged) <br/>
<img src="https://i.imgur.com/7VGd6vG.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
  **NOTE: In a live production environment, this is NOT recommended. Disabling the firewall is strictly for the application of this lab** <br/>
To enable connectivity, we're going to disable the firewall <br/>
 On the VM, type "wf.msc" on the search bar at the bottom <br/>
 Select "Windows Defender Firewall Properties" <br/>
 Turn "Firewall state" to "Off" on the Domain, Private, and Public profiles <br/>
 You'll notice on your host machine that pings are able to receive a response
<img src="https://i.imgur.com/JiU0iGx.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<img src="https://i.imgur.com/zUxbBnI.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
You may close the command prompt on the host machine since we have established that we can make a connection <br/>
 Open your Nessus Essentials tab and select "New Scan" -> Basic Network Scan <br/>
 Name your scan and place the IPv4 address of your VM in the "Targets" section. Select Save <br/>
 This first scan will be a non-credientialed scan (because we have not provided admin login) <br/>
<img src="https://i.imgur.com/vECpaxi.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
Congratulations! The first scan has been configured <br/>
 Select the play button on the right to "run" this first scan <br/>
 After the scan has completed (as denoted by a checkmark), click into the scan to see the results <br/>
<img src="https://i.imgur.com/FwUM3hB.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<img src="https://i.imgur.com/hy0dapU.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
By clicking on "Vulnerabilities", you are able to see the findings of the scan <br/>
 Depending on your organization's posture, there will be some vulnerabilities that are far more important to remediate than others <br/>
 Here is an example of one of the vulnerabilities found, possible solutions, and the CVSS scores <br/>
 If you aren't familiar with CVSS scores, they are a qualitative measure of (a vulnerability's) severity. <br/>
 Other bullets seen may simply be informative and not a vulnerability <br/>
<img src="https://i.imgur.com/xSpLQWB.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
 We're going to configure the VM to allow credentialed scans <br/>
 Type "services.msc" on the search bar below <br/>
 Locate and enable "Remote Registry" by setting "Startup type" to "Automatic" -> Apply -> Start <br/>
 You may close all open windows within the VM <br/>
<img src="https://i.imgur.com/zSWGq9b.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
Type "Advanced sharing settings" in the search bar below <br/>
 Verify that "file and printer sharing" is turned on <br/>
<img src="https://i.imgur.com/N5utuBz.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
 **Note: This is not recommended in a production environment. We are simply using these settings to make it easier to scan. <br/>
Type "User Account Control Settings" in the bottom search bar <br/>
Set the slider to "Never notify" -> Okay -> Yes <br/>
<img src="https://i.imgur.com/3OWggrP.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***IN YOUR VIRTUAL MACHINE AND NOT ON YOUR HOST MACHINE*** <br/>
 **Note: This is not recommended in a production environment. We are simply using these settings to make it easier to scan. <br/>
You're going to add a key to the registry that supposed to further disable the user access control for remote access <br/>
 Type "Registry Editor" in the search below <br/>
 Navigate to HKEY_LOCAL_MACHINE -> SOFTWARE -> Microsoft -> Windows -> CurrentVersion -> Policies -> System <br/>
 Verify that your path matches picture below <br/>
<img src="https://i.imgur.com/fdrCovR.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/> <br/>
Right click where you see the files on the right, select New -> DWORD (32-bit) Value <br/>
Name it "LocalAccountTokenFilterPolicy", hit enter, set Value data to 1 <br/>
Close the window, restart your VM, and log back in <br/>
<img src="https://i.imgur.com/54vbv9g.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/> <br/> 
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
In Nessus, select the check next to the scan intially created, select More -> Configure <br/>
 Select Credentials -> Windows -> Populate the "Username" and "Password" fields with what you set on the VM and hit Save <br/>
<img src="https://i.imgur.com/xA0bb7h.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />
***ON YOUR HOST MACHINE AND NOT IN YOUR VIRTUAL MACHINE*** <br/>
Navigate back to the "My Scans" page and re-run the scan with the play button <br/>
<img src="https://i.imgur.com/xGoxn8y.png" height="80%" width="80%" alt="Azure Sentinel SIEM Steps"/>
<br />
<br />



<h2>Thanks for viewing my home lab. Hope you get to try it out sometime!
Aloha, Jeremy</h2>

 
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
